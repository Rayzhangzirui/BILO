# BiLO: Bilevel Local Operator Learning for PDE Inverse Problems

This repository contains the code for the 2 manuscripts

[BiLO: Bilevel Local Operator Learning for PDE Inverse Problems. Part I: PDE-Constrained Optimization](https://arxiv.org/abs/2404.17789)

[BiLO: Bilevel Local Operator Learning for PDE Inverse Problems. Part II: Efficient Uncertainty Quantification with Low-Rank Adaptation](https://arxiv.org/abs/2507.17019)

## Tutorials

- Tutorial of estimating unknown scalar PDE paramters [Colab](https://colab.research.google.com/drive/16msmuzq-Nwdy_kJ4crD0dTGOvtZk2qL7?usp=sharing) [notebook](tutorial_scalar.ipynb) 
- Tutorial of estimating unknown function [Colab](https://colab.research.google.com/drive/162MO8YQSMrJC_ADywb9ofmnkyBvQuyYZ?usp=sharing) [notebook](tutorial_function.ipynb)
- Tutorial of using NVIDIA/physicsnemo-sym [Colab](https://colab.research.google.com/drive/1vWWejrgTYGWgijqm_0EpK03WEAUOLEJ8?usp=sharing) [notebook](tutorial_scalar_physicsnemo.ipynb)
- Tutorial of Bayesian inference with BiLO-HMC-LoRA. [Colab](https://colab.research.google.com/drive/1_DyWlZLVcWbq4v71Y__Uyukhxd-J4qTI?usp=sharing) [notebook](tutorial_bayes_lora.ipynb) 

## Citing
If you use BiLO, please cite the following papers:

```bibtex
@misc{bilo1,
      title={BiLO: Bilevel Local Operator Learning for PDE Inverse Problems. Part I: PDE-Constrained Optimization}, 
      author={Ray Zirui Zhang and Christopher E. Miles and Xiaohui Xie and John S. Lowengrub},
      year={2025},
      eprint={2404.17789},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2404.17789}, 
}

@misc{bilo2,
      title={BiLO: Bilevel Local Operator Learning for PDE Inverse Problems. Part II: Efficient Uncertainty Quantification with Low-Rank Adaptation}, 
      author={Ray Zirui Zhang and Christopher E. Miles and Xiaohui Xie and John S. Lowengrub},
      year={2025},
      eprint={2507.17019},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2507.17019}, 
}
```

## Experiments
To run the examples in part 1 and part 2, use the following command:
```python
python ExpScheduler.py examples_pdeco.yaml
python ExpScheduler.py examples_bayes.yaml
```
See the yaml files for the configuration of the experiments.

## Dataset
The pretrain datasets, which are numerical solutions generated by Matlab, can be found [here](https://drive.google.com/drive/folders/1_PF3SibVj25a_TAqJz7FBh74dW4nQV9w?usp=sharing). 
