# BiLO: Bilevel Local Operator Learning for PDE Inverse Problems

This repository contains the code for the two papers:

**BiLO: Bilevel Local Operator Learning for PDE Inverse Problems**
[[Paper](https://www.sciencedirect.com/science/article/pii/S002199912600029X)]
[[arxiv](https://arxiv.org/abs/2404.17789)]

**Bayesian BiLO: Bilevel Local Operator Learning for Efficient Uncertainty Quantification of Bayesian PDE Inverse Problems with Low-Rank Adaptation**
[[arxiv](https://arxiv.org/abs/2507.17019)]

## Tutorials

- Learning unknown scalar PDE paramters 
[[Colab](https://colab.research.google.com/drive/18AUEqm6lPA6WlkQYcsQqn9LPG7y2xw1E?usp=sharing)] [[notebook](tutorial_scalar.ipynb)]
- Learning unknown function [[Colab](https://colab.research.google.com/drive/1M7Z5JMt5n84BIM0Cyitm_-2noGC8ljlW?usp=sharing)] [[notebook](tutorial_function.ipynb)]
- Using NVIDIA/physicsnemo-sym [[Colab](https://colab.research.google.com/drive/1xnIZQfG4wGh7YFi-rJuwPTT5n0CLMC8O?usp=sharing)] [[notebook](tutorial_scalar_physicsnemo.ipynb)]
- Bayesian inference [[Colab](https://colab.research.google.com/drive/1eSZDHpb_Zr7pd2ArkqPQC4IMrHNvMJzE?usp=sharing)] [[notebook](tutorial_bayes_lora.ipynb)]

## Citing
If you use BiLO, please cite the following papers:

```bibtex
@article{zhangBiLOBilevelLocal2026,
  title = {{{BiLO}}: {{Bilevel Local Operator Learning}} for {{PDE Inverse Problems}}},
  shorttitle = {{{BiLO}}},
  author = {Zhang, Ray Zirui and Miles, Christopher E. and Xie, Xiaohui and Lowengrub, John S.},
  year = 2026,
  month = apr,
  journal = {Journal of Computational Physics},
  volume = {551},
  pages = {114679},
  issn = {0021-9991},
  doi = {10.1016/j.jcp.2026.114679},
}


@misc{bilo2,
      title={Bayesian BiLO: Bilevel Local Operator Learning for Efficient Uncertainty Quantification of Bayesian PDE Inverse Problems with Low-Rank Adaptation with Low-Rank Adaptation}, 
      author={Ray Zirui Zhang and Christopher E. Miles and Xiaohui Xie and John S. Lowengrub},
      year={2025},
      eprint={2507.17019},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2507.17019}, 
}
```

## Experiments
To run the full examples, use the following command:
```python
python ExpScheduler.py examples_pdeco.yaml
python ExpScheduler.py examples_bayes.yaml
```
See the yaml files for the configuration of the experiments.

## Dataset
The datasets [[link](https://drive.google.com/drive/folders/1_PF3SibVj25a_TAqJz7FBh74dW4nQV9w?usp=sharing)]
include some numerical solutions generated by Matlab.
